!function(){"use strict";class e{constructor(e,t,s){let{item:r,handleCardClick:n,handleDeleteButton:o,handleLikeButton:i}=e;var a,c;c=e=>{this._likes=e,this._renderLikes()},(a="handleLike")in this?Object.defineProperty(this,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):this[a]=c,this._cardSelector=t,this._item=r,this._name=r.name,this._link=r.link,this._likes=r.likes,this._ownerId=r.owner._id,this._handleCardClick=n,this._handleDeleteButton=o,this._handleLikeButton=i,this._id=r._id,this._userId=s}_getTemplate(){return this._element=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._element}_crossId(e){this._ownerId!==e._id&&(this._binButton.style.display="none")}checkForLikes(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._likeCounter.textContent=this._likes.length,this.checkForLikes()?this._likeButton.classList.add("card__like-button_black"):this._likeButton.classList.remove("card__like-button_black")}deleteCard(e){this._element.remove(),this._element=null}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeButton(this._id))),this._cardImage.addEventListener("click",this._handleCardClick),this._binButton.addEventListener("click",(()=>{this._handleDeleteButton(this._id)}))}generateCard(e){return this._element=this._getTemplate(),this._element.id=this._id,this._likeButton=this._element.querySelector(".card__like-button"),this._likeCounter=this._element.querySelector(".card__like-counter"),this._binButton=this._element.querySelector(".card__delete-button"),this._deleteButton=document.querySelector(".popup__button_type_delete"),this._cardImage=this._element.querySelector(".card__image"),this._element.querySelector(".card__name").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._crossId(e),this._renderLikes(),this._setEventListeners(),this._element}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass),t.textContent=e.validationMessage}_hideInputError(e){const t=this._form.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_hasValidInputs(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButton(){this._hasValidInputs()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e),e.value="",this._toggleButton()}))}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){s(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),s(this,"_handleMouseDown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()})),this._popupElement=e}open(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("mousedown",this._handleMouseDown)}close(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("mousedown",this._handleMouseDown)}}class n extends r{constructor(e,t,s){super(e),this._handleSubmit=t,this._form=this._popupElement.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input"),this._button=this._form.querySelector(".popup__button"),this._buttonText=s}saving(){this._button.textContent="saving..."}hideSaving(){this._button.textContent=this._buttonText}getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._form.reset()}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}const o=document.querySelector(".popup_type_profile"),i=document.querySelector(".profile__popup-button"),a=(document.querySelector(".popup__close_type_profile"),document.querySelector(".popup_type_avatar")),c=document.querySelector(".popup__form_type_avatar"),l=document.querySelector(".profile__avatar"),u=document.querySelector(".profile__avatar-box"),_=document.querySelector(".profile__name"),h=document.querySelector(".profile__job"),d=document.querySelector(".popup__form_type_profile"),p=d.elements.name,m=d.elements.about,v=(document.querySelector(".popup__form_type_avatar"),document.querySelector(".card__like-counter"),document.querySelector(".popup_type_place")),y=document.querySelector(".profile__add-button"),b=(document.querySelector(".popup__close_type_place"),v.querySelector(".popup__input_field_heading"),v.querySelector(".popup__input_field_img"),document.querySelector(".popup__form_type_place"),c.querySelector(".popup__input_field_img")),f=(document.querySelector("#card-template").content,document.querySelector(".cards"),document.querySelector(".popup_type_preview")),S=(document.querySelector(".popup__close_type_preview"),document.querySelector(".popup__image"),document.querySelector(".popup__heading"),document.querySelector(".popup_type_delete")),E={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible",imagePreview:".popup_type_preview"};document.querySelectorAll(".popup");const g=new class{constructor(e){let{baseUrl:t,headers:s}=e;var r,n;n=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))),(r="_customFetch")in this?Object.defineProperty(this,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[r]=n,this._baseUrl=t,this._headers=s}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}setUserInfo(e){let{name:t,about:s}=e;return this._customFetch("".concat(this._baseUrl,"/users/me "),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:t,about:s})})}setUserAvatar(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}createCard(e){return this._customFetch("".concat(this._baseUrl,"/cards "),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e," "),{headers:this._headers,method:"DELETE"})}likeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}unlikeCard(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"ad179248-85aa-46f0-9788-27fa8afcb4c4","Content-Type":"application/json"}});let k,C={};Promise.all([g.getUserInfo(),g.getInitialCards()]).then((e=>{let[t,s]=e;return C=t,k=t._id,w.renderItems(s.reverse()),q.setUserInfo(t),q.setUserAvatar(t.avatar),C})).catch((e=>{console.log("Error: ".concat(e))}));const L=new n(o,(function(){L.saving(),g.setUserInfo(L.getInputValues()).then((e=>{q.setUserInfo(e),L.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{L.hideSaving()}))}),"save");L.setEventListeners(),new t(E,d);const q=new class{constructor(e,t,s){this._name=e,this._about=t,this._avatar=s}getUserAvatar(){return{avatar:this._avatar.src}}setUserAvatar(e){this._avatar.src=e}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){this._name.textContent=e.name,this._about.textContent=e.about}}(_,h,l);i.addEventListener("click",(()=>{A.profileform.resetValidation();const e=q.getUserInfo();p.value=e.name,m.value=e.about,L.open()}));const I=new n(a,(function(){const e=I.getInputValues();I.saving(),g.setUserAvatar(e.avatarImage).then((e=>{q.setUserAvatar(e.avatar),I.close()})).catch((e=>{console.log("Error: ".concat(e))})).finally((()=>{I.hideSaving()}))}),"save");I.setEventListeners(),u.addEventListener("click",(()=>{A.avatarform.resetValidation(),b.textContent=q.getUserAvatar(),I.open()}));const w=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>this.addItem(e)))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}({renderer:t=>{const s=new e({item:t,handleCardClick:()=>{x.open({item:t})},handleDeleteButton:e=>{U.open(),U.setAction((()=>{g.deleteCard(e).then((()=>{s.deleteCard(),U.close()})).catch((e=>{console.log("Error: ".concat(e))}))}))},handleLikeButton:e=>{s.checkForLikes()?g.unlikeCard(e).then((e=>{s.handleLike(e.likes)})).catch((e=>{console.log("Error: ".concat(e))})):g.likeCard(e).then((e=>{s.handleLike(e.likes)})).catch((e=>{console.log("Error: ".concat(e))}))}},".card-template",k);return s.generateCard(C)}},".cards"),B=new n(v,(function(){B.saving();const e=B.getInputValues(),t={name:e.placeHeading,link:e.placeImage};g.createCard(t).then((e=>{w.addItem(e),B.close()})).catch((e=>{console.log("Error: ".concat(err))})).finally((()=>{B.hideSaving()}))}),"create");B.setEventListeners(),y.addEventListener("click",(()=>{A.placeform.resetValidation(),B.open()}));const U=new class extends r{constructor(e){super(e),this._form=this._popupElement.querySelector(".popup__form_type_delete")}setAction(e){this._handleSubmit=e}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}}(S);U.setEventListeners();const x=new class extends r{constructor(e){super(e),this._image=this._popupElement.querySelector(".popup__image"),this._caption=this._popupElement.querySelector(".popup__heading")}open(e){let{item:t}=e;this._image.src=t.link,this._image.alt="".concat(t.name," photo"),this._caption.textContent=t.name,super.open()}}(f),A={};(e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((s=>{const r=new t(e,s),n=s.getAttribute("name");A[n]=r,r.enableValidation()}))})(E)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQWlCbEMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeyBpdGVtLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUJ1dHRvbiwgaGFuZGxlTGlrZUJ1dHRvbiB9LFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgdXNlcklkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pdGVtID0gaXRlbTtcclxuICAgIHRoaXMuX25hbWUgPSBpdGVtLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gaXRlbS5saW5rO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBpdGVtLmxpa2VzO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGl0ZW0ub3duZXIuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICB0aGlzLl9pZCA9IGl0ZW0uX2lkO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG4gIF9jcm9zc0lkKGRhdGEpIHtcclxuICAgIGlmICh0aGlzLl9vd25lcklkICE9PSBkYXRhLl9pZCkge1xyXG4gICAgICB0aGlzLl9iaW5CdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY2hlY2tGb3JMaWtlcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcbiAgaGFuZGxlTGlrZSA9IChuZXdMaWtlcykgPT4ge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XHJcbiAgfTtcclxuICBfcmVuZGVyTGlrZXMoKSB7XHJcbiAgICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcclxuICAgIGlmICh0aGlzLmNoZWNrRm9yTGlrZXMoKSkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9ibGFja1wiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2JsYWNrXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChfaWQpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VCdXR0b24odGhpcy5faWQpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDYXJkQ2xpY2spO1xyXG4gICAgdGhpcy5fYmluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbih0aGlzLl9pZCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZ2VuZXJhdGVDYXJkKGRhdGEpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudC5pZCA9IHRoaXMuX2lkO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuICAgIHRoaXMuX2JpbkJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fYnV0dG9uX3R5cGVfZGVsZXRlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX25hbWVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2Nyb3NzSWQoZGF0YSk7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JTcGFuID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JTcGFuLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvclNwYW4udGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvclNwYW4gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvclNwYW4uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yU3Bhbi50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfaGFzVmFsaWRJbnB1dHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dHMoKSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICAgIGlucHV0RWxlbWVudC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvbigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4gZXZlbnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBwb3B1cEVsZW1lbnQ7XHJcbiAgfVxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gIF9oYW5kbGVNb3VzZURvd24gPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpIHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU1vdXNlRG93bik7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVNb3VzZURvd24pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBFbGVtZW50LCBoYW5kbGVTdWJtaXQsIGJ1dHRvblRleHQpIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9idXR0b25UZXh0ID0gYnV0dG9uVGV4dDtcclxuICB9XHJcblxyXG4gIHNhdmluZygpIHtcclxuICAgIHRoaXMuX2J1dHRvbi50ZXh0Q29udGVudCA9IFwic2F2aW5nLi4uXCI7XHJcbiAgfVxyXG4gIGhpZGVTYXZpbmcoKSB7XHJcbiAgICB0aGlzLl9idXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xyXG4gIH1cclxuICBnZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGRhdGEgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBkYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCIvL3Byb2ZpbGUgcmVsYXRlZFxyXG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9wcm9maWxlXCIpO1xyXG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19wb3B1cC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcG9wdXBQcm9maWxlQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnBvcHVwX19jbG9zZV90eXBlX3Byb2ZpbGVcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcG9wdXBBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfYXZhdGFyXCIpO1xyXG5leHBvcnQgY29uc3QgZm9ybUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9hdmF0YXJcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEF2YXRhckVkaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1ib3hcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2pvYlwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV90eXBlX3Byb2ZpbGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybU5hbWVJbnB1dCA9IHByb2ZpbGVGb3JtLmVsZW1lbnRzLm5hbWU7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybUpvYklucHV0ID0gcHJvZmlsZUZvcm0uZWxlbWVudHMuYWJvdXQ7XHJcbmV4cG9ydCBjb25zdCBwb3B1cFVzZXJBdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9fZm9ybV90eXBlX2F2YXRhclwiXHJcbik7XHJcblxyXG4vL2NhcmQgcmVsYXRlZFxyXG5leHBvcnQgY29uc3QgY2FyZExpa2VDb3VudGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50ZXJcIik7XHJcbmV4cG9ydCBjb25zdCBhZGRQbGFjZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF90eXBlX3BsYWNlXCIpO1xyXG5leHBvcnQgY29uc3QgYWRkUGxhY2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBjbG9zZUFkZFBsYWNlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9fY2xvc2VfdHlwZV9wbGFjZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZFBsYWNlUG9wdXAucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9faW5wdXRfZmllbGRfaGVhZGluZ1wiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW1hZ2VJbnB1dCA9IGFkZFBsYWNlUG9wdXAucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9faW5wdXRfZmllbGRfaW1nXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybV90eXBlX3BsYWNlXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFySW1hZ2VJbnB1dCA9IGZvcm1BdmF0YXIucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF9faW5wdXRfZmllbGRfaW1nXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xyXG5leHBvcnQgY29uc3QgY2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNcIik7XHJcbmV4cG9ydCBjb25zdCBpbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfcHJldmlld1wiKTtcclxuZXhwb3J0IGNvbnN0IHByZXZpZXdDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucG9wdXBfX2Nsb3NlX3R5cGVfcHJldmlld1wiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRIZWFkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faGVhZGluZ1wiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQ2FyZERlbGV0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9kZWxldGVcIik7XHJcblxyXG4vLyBwb3B1cCByZWxhdGVkXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbiAgaW1hZ2VQcmV2aWV3OiBcIi5wb3B1cF90eXBlX3ByZXZpZXdcIixcclxufTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBcIik7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG4gIC8vLy8vLy8vLy8vLy9jdXN0b20gZmV0Y2gvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgX2N1c3RvbUZldGNoID0gKHVybCwgaGVhZGVycykgPT4ge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgaGVhZGVycykudGhlbigocmVzKSA9PlxyXG4gICAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YClcclxuICAgICk7XHJcbiAgfTtcclxuICAvLy8vLy8vLy8vLy8vLy8vLy8vdXNlciBwcm9maWxlLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZSBgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG5cclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHNldFVzZXJBdmF0YXIoZGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBkYXRhIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL2NhcmRzLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuICBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcyBgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGl0ZW0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0gYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHVubGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9BcGkgaW5zdGFuY2UvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5leHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJhZDE3OTI0OC04NWFhLTQ2ZjAtOTc4OC0yN2ZhOGFmY2I0YzRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHtcclxuICBzZXR0aW5ncyxcclxuICBwb3B1cFByb2ZpbGVGb3JtLFxyXG4gIHBvcHVwUHJvZmlsZUJ1dHRvbixcclxuICBhZGRQbGFjZUJ1dHRvbixcclxuICBwcm9maWxlSm9iLFxyXG4gIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVGb3JtSm9iSW5wdXQsXHJcbiAgcHJvZmlsZUZvcm1OYW1lSW5wdXQsXHJcbiAgY2FyZEZvcm0sXHJcbiAgcHJvZmlsZUZvcm0sXHJcbiAgYWRkUGxhY2VQb3B1cCxcclxuICBpbWFnZVByZXZpZXcsXHJcbiAgcG9wdXBBdmF0YXIsXHJcbiAgZm9ybUF2YXRhcixcclxuICBwb3B1cEF2YXRhckVkaXQsXHJcbiAgcHJvZmlsZUF2YXRhcixcclxuICBhdmF0YXJJbWFnZUlucHV0LFxyXG4gIHBvcHVwQ2FyZERlbGV0ZSxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoU3VibWl0XCI7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5sZXQgbmV3SW5mbyA9IHt9O1xyXG5sZXQgdXNlcklkO1xyXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZERhdGFdKSA9PiB7XHJcbiAgICBuZXdJbmZvID0gdXNlckRhdGE7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICBjYXJkTGlzdC5yZW5kZXJJdGVtcyhjYXJkRGF0YS5yZXZlcnNlKCkpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gICAgcmV0dXJuIG5ld0luZm87XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICB9KTtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL3Byb2ZpbGUvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHBvcHVwUHJvZmlsZUZvcm0sXHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsXHJcbiAgXCJzYXZlXCJcclxuKTtcclxucG9wdXBFZGl0UHJvZmlsZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgcG9wdXBQcm9maWxlID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVGb3JtKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVOYW1lLCBwcm9maWxlSm9iLCBwcm9maWxlQXZhdGFyKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KCkge1xyXG4gIHBvcHVwRWRpdFByb2ZpbGUuc2F2aW5nKCk7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckluZm8ocG9wdXBFZGl0UHJvZmlsZS5nZXRJbnB1dFZhbHVlcygpKVxyXG4gICAgLnRoZW4oKGluZm8pID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5mbyk7XHJcblxyXG4gICAgICBwb3B1cEVkaXRQcm9maWxlLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwRWRpdFByb2ZpbGUuaGlkZVNhdmluZygpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnBvcHVwUHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgY29uc3QgdXNlck5ld0luZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVGb3JtTmFtZUlucHV0LnZhbHVlID0gdXNlck5ld0luZm8ubmFtZTtcclxuICBwcm9maWxlRm9ybUpvYklucHV0LnZhbHVlID0gdXNlck5ld0luZm8uYWJvdXQ7XHJcbiAgcG9wdXBFZGl0UHJvZmlsZS5vcGVuKCk7XHJcbn0pO1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vYXZhdGFyLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgcG9wdXBVc2VyQXZhdGFyID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgcG9wdXBBdmF0YXIsXHJcbiAgaGFuZGxlQXZhdGFyU3VibWl0LFxyXG4gIFwic2F2ZVwiXHJcbik7XHJcbnBvcHVwVXNlckF2YXRhci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KCkge1xyXG4gIGNvbnN0IGRhdGEgPSBwb3B1cFVzZXJBdmF0YXIuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICBwb3B1cFVzZXJBdmF0YXIuc2F2aW5nKCk7XHJcbiAgYXBpXHJcbiAgICAuc2V0VXNlckF2YXRhcihkYXRhLmF2YXRhckltYWdlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xyXG4gICAgICBwb3B1cFVzZXJBdmF0YXIuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBVc2VyQXZhdGFyLmhpZGVTYXZpbmcoKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5wb3B1cEF2YXRhckVkaXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhcmZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFySW1hZ2VJbnB1dC50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmdldFVzZXJBdmF0YXIoKTtcclxuXHJcbiAgcG9wdXBVc2VyQXZhdGFyLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9jYXJkLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vL2NhcmRzIGZyb20gc2VydmVyLy9cclxuY29uc3QgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGl0ZW0sXHJcbiAgICAgICAgICBoYW5kbGVDYXJkQ2xpY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgcG9wdXBJbWFnZS5vcGVuKHsgaXRlbSB9KTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBoYW5kbGVEZWxldGVCdXR0b246IChpZCkgPT4ge1xyXG4gICAgICAgICAgICBjYXJkRGVsZXRlUG9wdXAub3BlbigpO1xyXG4gICAgICAgICAgICBjYXJkRGVsZXRlUG9wdXAuc2V0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcclxuICAgICAgICAgICAgICAgICAgY2FyZERlbGV0ZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBoYW5kbGVMaWtlQnV0dG9uOiAoaWQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXNsaWtlZCA9IGNhcmQuY2hlY2tGb3JMaWtlcygpO1xyXG4gICAgICAgICAgICBpZiAoaXNsaWtlZCkge1xyXG4gICAgICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAgICAgLnVubGlrZUNhcmQoaWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNhcmQuaGFuZGxlTGlrZShyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogJHtlcnJ9YCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAgIC5saWtlQ2FyZChpZClcclxuICAgICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY2FyZC5oYW5kbGVMaWtlKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycn1gKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIFwiLmNhcmQtdGVtcGxhdGVcIixcclxuICAgICAgICB1c2VySWRcclxuICAgICAgKTtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZChuZXdJbmZvKTtcclxuICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiLmNhcmRzXCJcclxuKTtcclxuXHJcbmNvbnN0IHBvcHVwQWRkQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBhZGRQbGFjZVBvcHVwLFxyXG4gIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0LFxyXG4gIFwiY3JlYXRlXCJcclxuKTtcclxucG9wdXBBZGRDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoKSB7XHJcbiAgcG9wdXBBZGRDYXJkRm9ybS5zYXZpbmcoKTtcclxuICBjb25zdCBuZXdWYWx1ZXMgPSBwb3B1cEFkZENhcmRGb3JtLmdldElucHV0VmFsdWVzKCk7XHJcbiAgY29uc3QgaXRlbSA9IHtcclxuICAgIG5hbWU6IG5ld1ZhbHVlcy5wbGFjZUhlYWRpbmcsXHJcbiAgICBsaW5rOiBuZXdWYWx1ZXMucGxhY2VJbWFnZSxcclxuICB9O1xyXG4gIGFwaVxyXG4gICAgLmNyZWF0ZUNhcmQoaXRlbSlcclxuICAgIC50aGVuKChpdGVtKSA9PiB7XHJcbiAgICAgIGNhcmRMaXN0LmFkZEl0ZW0oaXRlbSk7XHJcbiAgICAgIHBvcHVwQWRkQ2FyZEZvcm0uY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKHJlcykgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyfWApO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBBZGRDYXJkRm9ybS5oaWRlU2F2aW5nKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYWRkUGxhY2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmb3JtVmFsaWRhdG9yc1tcInBsYWNlZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuXHJcbiAgcG9wdXBBZGRDYXJkRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBjYXJkIGRlbGV0ZSAvLy8vLy8vLy8vLy8vLy8vLy8vXHJcbmNvbnN0IGNhcmREZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhTdWJtaXQocG9wdXBDYXJkRGVsZXRlKTtcclxuY2FyZERlbGV0ZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vaW1hZ2UvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKGltYWdlUHJldmlldyk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuLy8gZW5hYmxlIHZhbGlkYXRpb25cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChzZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpO1xyXG4gICAgLy8gaGVyZSB5b3UgZ2V0IHRoZSBuYW1lIG9mIHRoZSBmb3JtXHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICAvLyBoZXJlIHlvdSBzdG9yZSBhIHZhbGlkYXRvciBieSB0aGUgYG5hbWVgIG9mIHRoZSBmb3JtXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcihwcm9maWxlTmFtZSwgcHJvZmlsZUFib3V0LCBwcm9maWxlQXZhdGFyKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gcHJvZmlsZU5hbWU7XHJcbiAgICB0aGlzLl9hYm91dCA9IHByb2ZpbGVBYm91dDtcclxuICAgIHRoaXMuX2F2YXRhciA9IHByb2ZpbGVBdmF0YXI7XHJcbiAgfVxyXG4gIGdldFVzZXJBdmF0YXIoKSB7XHJcbiAgICByZXR1cm4geyBhdmF0YXI6IHRoaXMuX2F2YXRhci5zcmMgfTtcclxuICB9XHJcbiAgc2V0VXNlckF2YXRhcihkYXRhKSB7XHJcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gZGF0YTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2Fib3V0LnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuYWRkSXRlbShpdGVtKSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9kZWxldGVcIik7XHJcbiAgfVxyXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faGVhZGluZ1wiKTtcclxuICB9XHJcbiAgb3Blbih7IGl0ZW0gfSkge1xyXG4gICAgdGhpcy5faW1hZ2Uuc3JjID0gaXRlbS5saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYCR7aXRlbS5uYW1lfSBwaG90b2A7XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gaXRlbS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiY2FyZFNlbGVjdG9yIiwidXNlcklkIiwiaXRlbSIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2VCdXR0b24iLCJuZXdMaWtlcyIsInRoaXMiLCJfbGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX2l0ZW0iLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiX3VzZXJJZCIsIl9nZXRUZW1wbGF0ZSIsIl9lbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jcm9zc0lkIiwiZGF0YSIsIl9iaW5CdXR0b24iLCJzdHlsZSIsImRpc3BsYXkiLCJjaGVja0Zvckxpa2VzIiwic29tZSIsImxpa2UiLCJfbGlrZUNvdW50ZXIiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiZGVsZXRlQ2FyZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2FyZEltYWdlIiwiZ2VuZXJhdGVDYXJkIiwiaWQiLCJfZGVsZXRlQnV0dG9uIiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvclNwYW4iLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNWYWxpZElucHV0cyIsIl9pbnB1dExpc3QiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b24iLCJfYnV0dG9uRWxlbWVudCIsImRpc2FibGVkIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cEVsZW1lbnQiLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlTW91c2VEb3duIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJidXR0b25UZXh0Iiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2J1dHRvbiIsIl9idXR0b25UZXh0Iiwic2F2aW5nIiwiaGlkZVNhdmluZyIsImdldElucHV0VmFsdWVzIiwiaW5wdXQiLCJyZXNldCIsInNldEV2ZW50TGlzdGVuZXJzIiwicG9wdXBQcm9maWxlRm9ybSIsInBvcHVwUHJvZmlsZUJ1dHRvbiIsInBvcHVwQXZhdGFyIiwiZm9ybUF2YXRhciIsInByb2ZpbGVBdmF0YXIiLCJwb3B1cEF2YXRhckVkaXQiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVKb2IiLCJwcm9maWxlRm9ybSIsInByb2ZpbGVGb3JtTmFtZUlucHV0IiwiZWxlbWVudHMiLCJwcm9maWxlRm9ybUpvYklucHV0IiwiYWJvdXQiLCJhZGRQbGFjZVBvcHVwIiwiYWRkUGxhY2VCdXR0b24iLCJhdmF0YXJJbWFnZUlucHV0IiwiaW1hZ2VQcmV2aWV3IiwicG9wdXBDYXJkRGVsZXRlIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldFVzZXJJbmZvIiwiX2N1c3RvbUZldGNoIiwic2V0VXNlckluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNldFVzZXJBdmF0YXIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJjcmVhdGVDYXJkIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsIm5ld0luZm8iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmREYXRhIiwiY2FyZExpc3QiLCJyZW5kZXJJdGVtcyIsInJldmVyc2UiLCJ1c2VySW5mbyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInBvcHVwRWRpdFByb2ZpbGUiLCJpbmZvIiwiZmluYWxseSIsInByb2ZpbGVBYm91dCIsIl9hYm91dCIsIl9hdmF0YXIiLCJnZXRVc2VyQXZhdGFyIiwiZm9ybVZhbGlkYXRvcnMiLCJ1c2VyTmV3SW5mbyIsInBvcHVwVXNlckF2YXRhciIsImF2YXRhckltYWdlIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtcyIsImFkZEl0ZW0iLCJjYXJkIiwicHJlcGVuZCIsInBvcHVwSW1hZ2UiLCJjYXJkRGVsZXRlUG9wdXAiLCJzZXRBY3Rpb24iLCJoYW5kbGVMaWtlIiwicG9wdXBBZGRDYXJkRm9ybSIsIm5ld1ZhbHVlcyIsInBsYWNlSGVhZGluZyIsInBsYWNlSW1hZ2UiLCJhY3Rpb24iLCJfaW1hZ2UiLCJfY2FwdGlvbiIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==